#!/usr/bin/python2

import sys
import thread
import getopt

from serial import serial

device = '' # /dev/ttyACM0
baud   = '' #9600

try:
    opts, args = getopt.getopt(sys.argv[1:], 'd:b', ['device=','baud='])
except getopt.GetoptError:
    sys.stderr.write("Invalid commandline argument.")
    sys.exit(2)

for opt, arg in opts:
    if opt in ('--device','d'):
        device = arg
    if opt in ('--baud','b'):
        baud = arg

if not baud or not device:
    sys.stderr.write("Device and Baud rate are required.")
	sys.exit(2)

arduino = serial.Serial(device,baud,timeout=30)

#start threads
try:
    serialInThread = serialIn(1, "SerialIn", arduino)
    serialInThread.start()
    
except:
    sys.stderr.write("Error. Unable to start threads.")
